<div class="max-w-5xl mx-auto px-6 py-8">
  <h1 class="text-4xl font-bold text-gray-800 mb-2">Custom Form Controls</h1>
  <p class="text-lg text-gray-600 mb-8">
    Build custom controls with just a <code>model()</code> signal. No more
    <code>ControlValueAccessor</code> boilerplate!
  </p>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Form -->
    <div class="bg-white rounded-lg shadow-md p-6">
      <h2 class="text-2xl font-semibold mb-6">Product Review</h2>

      <div class="space-y-5">
        <!-- Title -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1"
            >Review Title</label
          >
          <input
            type="text"
            [formField]="reviewForm.title"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 outline-none transition"
            placeholder="Great product!"
          />
          @if (reviewForm.title().touched() && reviewForm.title().invalid()) {
            @for (error of reviewForm.title().errors(); track error.kind) {
              <p class="text-red-600 text-sm mt-1">{{ error.message }}</p>
            }
          }
        </div>

        <!-- Star Rating (Custom Control) -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Rating
            <span class="text-xs text-purple-600 ml-1"
              >(Custom FormValueControl)</span
            >
          </label>
          <app-star-rating [formField]="reviewForm.rating" />
          @if (reviewForm.rating().touched() && reviewForm.rating().invalid()) {
            @for (error of reviewForm.rating().errors(); track error.kind) {
              <p class="text-red-600 text-sm mt-1">{{ error.message }}</p>
            }
          }
        </div>

        <!-- Review Text -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1"
            >Review</label
          >
          <textarea
            [formField]="reviewForm.text"
            rows="4"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 outline-none transition resize-none"
            placeholder="What did you like about this product?"
          ></textarea>
          @if (reviewForm.text().touched() && reviewForm.text().invalid()) {
            @for (error of reviewForm.text().errors(); track error.kind) {
              <p class="text-red-600 text-sm mt-1">{{ error.message }}</p>
            }
          }
        </div>

        <!-- Tags (Custom Control) -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Tags
            <span class="text-xs text-purple-600 ml-1"
              >(Custom FormValueControl)</span
            >
          </label>
          <app-tag-input [formField]="reviewForm.tags" />
          @if (reviewForm.tags().touched() && reviewForm.tags().invalid()) {
            @for (error of reviewForm.tags().errors(); track error.kind) {
              <p class="text-red-600 text-sm mt-1">{{ error.message }}</p>
            }
          }
        </div>

        <!-- Recommend Toggle (Custom Control) -->
        <div class="flex items-center gap-3">
          <app-toggle-switch [formField]="reviewForm.recommend" />
          <label class="text-sm font-medium text-gray-700">
            I would recommend this product
            <span class="text-xs text-purple-600 ml-1"
              >(Custom FormCheckboxControl)</span
            >
          </label>
        </div>

        <!-- Anonymous Toggle -->
        <div class="flex items-center gap-3">
          <app-toggle-switch [formField]="reviewForm.anonymous" />
          <label class="text-sm font-medium text-gray-700"
            >Post anonymously</label
          >
        </div>

        <button
          class="w-full bg-red-600 text-white py-3 rounded-lg font-semibold hover:bg-red-700 transition disabled:opacity-50"
          [disabled]="reviewForm().invalid()"
        >
          Submit Review
        </button>
      </div>
    </div>

    <!-- Right Panel -->
    <div class="space-y-4">
      <div class="bg-gray-900 text-green-400 rounded-lg p-6 font-mono text-sm">
        <h3 class="text-white font-bold mb-4 font-sans text-lg">Live State</h3>

        <div class="mb-3">
          <span class="text-gray-400">// Custom star rating control</span><br />
          <span class="text-yellow-300">rating.value</span> =
          {{ reviewForm.rating().value() }}<br />
          <span class="text-yellow-300">rating.valid</span> =
          {{ reviewForm.rating().valid() }}<br />
          <span class="text-yellow-300">rating.touched</span> =
          {{ reviewForm.rating().touched() }}
        </div>

        <div class="mb-3">
          <span class="text-gray-400">// Custom tag input control</span><br />
          <span class="text-yellow-300">tags.value</span> =
          {{ reviewForm.tags().value() | json }}<br />
          <span class="text-yellow-300">tags.valid</span> =
          {{ reviewForm.tags().valid() }}
        </div>

        <div class="mb-3">
          <span class="text-gray-400">// Custom toggle switches</span><br />
          <span class="text-yellow-300">recommend</span> =
          {{ reviewForm.recommend().value() }}<br />
          <span class="text-yellow-300">anonymous</span> =
          {{ reviewForm.anonymous().value() }}
        </div>

        <div>
          <span class="text-gray-400">// Full model</span><br />
          <span class="text-yellow-300">model</span> =
          {{ reviewModel() | json }}
        </div>
      </div>

      <!-- Code -->
      <div
        class="bg-gray-900 text-gray-100 rounded-lg p-6 font-mono text-xs overflow-x-auto"
      >
        <h3 class="text-white font-bold mb-3 font-sans text-lg">
          FormValueControl
        </h3>
        <pre
          class="whitespace-pre-wrap"
        ><span class="text-gray-400">// That's ALL you need for a custom control!</span>
<span class="text-purple-400">export class</span> <span class="text-yellow-300">StarRatingComponent</span>
  <span class="text-purple-400">implements</span> <span class="text-yellow-300">FormValueControl</span>&lt;number&gt; {{ '{' }}

          <span class="text-gray-400">// Required: just one model signal</span>
  <span class="text-purple-400">readonly</span> value = <span class="text-yellow-300">model</span>(0);

  <span class="text-gray-400">// Optional: auto-bound by [formField]</span>
  <span class="text-purple-400">readonly</span> disabled = <span class="text-yellow-300">input</span>(false);
  <span class="text-purple-400">readonly</span> touched = <span class="text-yellow-300">model</span>(false);
  <span class="text-purple-400">readonly</span> errors = <span class="text-yellow-300">input</span>([]);
          {{ '}' }}

          <span class="text-gray-400">// Usage: same [formField] as native inputs</span>
&lt;app-star-rating [formField]="form.rating" /&gt;</pre>
      </div>

      <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-blue-800 mb-3">Key Takeaways</h3>
        <ul class="space-y-2 text-blue-900 text-sm">
          <li>
            <strong>FormValueControl&lt;T&gt;</strong> - just needs
            <code>value = model&lt;T&gt;()</code>
          </li>
          <li>
            <strong>FormCheckboxControl</strong> - just needs
            <code>checked = model(false)</code>
          </li>
          <li>
            Optional inputs (disabled, touched, errors, etc.) are auto-bound
          </li>
          <li>No NG_VALUE_ACCESSOR, no writeValue(), no registerOnChange()</li>
          <li>
            Same <code>[formField]</code> directive works for native AND custom
            controls
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
