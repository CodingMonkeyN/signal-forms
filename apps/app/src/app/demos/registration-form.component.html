<div class="max-w-5xl mx-auto px-6 py-8">
  <h1 class="text-4xl font-bold text-gray-800 mb-2">Registration Form</h1>
  <p class="text-lg text-gray-600 mb-8">
    Custom validators, cross-field validation (confirm password), and form
    submission.
  </p>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Form -->
    <div class="bg-white rounded-lg shadow-md p-6">
      <h2 class="text-2xl font-semibold mb-6">Create Account</h2>

      <div class="space-y-5">
        <!-- Username -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1"
            >Username</label
          >
          <input
            type="text"
            [formField]="regForm.username"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none transition"
            placeholder="Choose a username"
          />
          @if (regForm.username().touched() && regForm.username().invalid()) {
            <div class="mt-1 space-y-1">
              @for (error of regForm.username().errors(); track error.kind) {
                <p class="text-red-600 text-sm">{{ error.message }}</p>
              }
            </div>
          }
        </div>

        <!-- Email -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1"
            >Email</label
          >
          <input
            type="email"
            [formField]="regForm.email"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none transition"
            placeholder="you&#64;example.com"
          />
          @if (regForm.email().touched() && regForm.email().invalid()) {
            <div class="mt-1 space-y-1">
              @for (error of regForm.email().errors(); track error.kind) {
                <p class="text-red-600 text-sm">{{ error.message }}</p>
              }
            </div>
          }
        </div>

        <!-- Phone -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1"
            >Phone</label
          >
          <input
            type="tel"
            [formField]="regForm.phone"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none transition"
            placeholder="+49 170 1234567"
          />
          @if (regForm.phone().touched() && regForm.phone().invalid()) {
            <div class="mt-1 space-y-1">
              @for (error of regForm.phone().errors(); track error.kind) {
                <p class="text-red-600 text-sm">{{ error.message }}</p>
              }
            </div>
          }
        </div>

        <!-- Password -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1"
            >Password</label
          >
          <input
            type="password"
            [formField]="regForm.password"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none transition"
            placeholder="At least 8 characters"
          />
          @if (regForm.password().touched() && regForm.password().invalid()) {
            <div class="mt-1 space-y-1">
              @for (error of regForm.password().errors(); track error.kind) {
                <p class="text-red-600 text-sm">{{ error.message }}</p>
              }
            </div>
          }
        </div>

        <!-- Confirm Password -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1"
            >Confirm Password</label
          >
          <input
            type="password"
            [formField]="regForm.confirmPassword"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none transition"
            placeholder="Repeat your password"
          />
          @if (
            regForm.confirmPassword().touched() &&
            regForm.confirmPassword().invalid()
          ) {
            <div class="mt-1 space-y-1">
              @for (
                error of regForm.confirmPassword().errors();
                track error.kind
              ) {
                <p class="text-red-600 text-sm">{{ error.message }}</p>
              }
            </div>
          }
        </div>

        <!-- Bio -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Bio
            <span class="text-gray-400"
              >({{ regForm.bio().value().length }}/200)</span
            >
          </label>
          <textarea
            [formField]="regForm.bio"
            rows="3"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none transition resize-none"
            placeholder="Tell us about yourself"
          ></textarea>
          @if (regForm.bio().touched() && regForm.bio().invalid()) {
            <div class="mt-1 space-y-1">
              @for (error of regForm.bio().errors(); track error.kind) {
                <p class="text-red-600 text-sm">{{ error.message }}</p>
              }
            </div>
          }
        </div>

        <button
          class="w-full bg-red-600 text-white py-3 rounded-lg font-semibold hover:bg-red-700 transition disabled:opacity-50"
          [disabled]="regForm().invalid() || regForm().submitting()"
          (click)="onSubmit()"
        >
          {{
            regForm().submitting() ? 'Creating Account...' : 'Create Account'
          }}
        </button>

        @if (submitted) {
          <div
            class="bg-green-50 border border-green-200 rounded-lg p-4 text-green-800"
          >
            Account created successfully!
          </div>
        }
      </div>
    </div>

    <!-- Right Panel -->
    <div class="space-y-4">
      <!-- Live State -->
      <div class="bg-gray-900 text-green-400 rounded-lg p-6 font-mono text-sm">
        <h3 class="text-white font-bold mb-4 font-sans text-lg">
          Live Form State
        </h3>

        <div class="mb-3">
          <span class="text-gray-400">// Form-level state</span><br />
          <span class="text-yellow-300">form.valid</span> =
          {{ regForm().valid() }}<br />
          <span class="text-yellow-300">form.dirty</span> =
          {{ regForm().dirty() }}<br />
          <span class="text-yellow-300">form.submitting</span> =
          {{ regForm().submitting() }}
        </div>

        <div class="mb-3">
          <span class="text-gray-400">// Cross-field: confirmPassword</span
          ><br />
          <span class="text-yellow-300">password</span> = "{{
            regForm.password().value()
          }}"<br />
          <span class="text-yellow-300">confirmPassword</span> = "{{
            regForm.confirmPassword().value()
          }}"<br />
          <span class="text-yellow-300">match?</span> =
          {{ regForm.password().value() === regForm.confirmPassword().value()
          }}<br />
          <span class="text-yellow-300">errors</span> =
          {{ regForm.confirmPassword().errors() | json }}
        </div>

        <div>
          <span class="text-gray-400">// Model value</span><br />
          <span class="text-yellow-300">model</span> =
          {{ regModel() | json }}
        </div>
      </div>

      <!-- Key Takeaways -->
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-blue-800 mb-3">Key Takeaways</h3>
        <ul class="space-y-2 text-blue-900 text-sm">
          <li><strong>validate()</strong> creates custom sync validators</li>
          <li>
            <strong>valueOf()</strong> reads other fields - auto-tracks
            dependencies!
          </li>
          <li>
            Cross-field validators automatically re-run when
            <em>any</em> read signal changes
          </li>
          <li>
            <strong>submit()</strong> marks all touched, validates, then runs
            callback
          </li>
          <li><strong>submitting()</strong> signal for loading state</li>
        </ul>
      </div>

      <!-- Code Highlight -->
      <div
        class="bg-gray-900 text-gray-100 rounded-lg p-6 font-mono text-sm overflow-x-auto"
      >
        <h3 class="text-white font-bold mb-3 font-sans text-lg">
          Cross-Field Validation
        </h3>
        <pre
          class="whitespace-pre-wrap"
        ><span class="text-gray-400">// Automatically re-runs when either field changes!</span>
<span class="text-yellow-300">validate</span>(reg.confirmPassword, ({{ '{' }} value, valueOf {{ '}' }}) => {{ '{' }}
          <span class="text-purple-400">if</span> (value() !== valueOf(reg.password)) {{ '{' }}
          <span class="text-purple-400">return</span> {{ '{' }}
          kind: <span class="text-green-400">'passwordMismatch'</span>,
      message: <span class="text-green-400">'Passwords do not match'</span>
          {{ '}' }};
          {{ '}' }}
          <span class="text-purple-400">return</span> <span class="text-yellow-300">null</span>;
          {{ '}' }});</pre>
      </div>
    </div>
  </div>
</div>
